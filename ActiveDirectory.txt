üß© ACTIVE DIRECTORY (AAD) PEOPLE PICKER ‚Äì POWER APPS STEPS
--------------------------------------------------------

üîç 1) QUERY USERS FROM AZURE AD (LIMIT TO 6)
Text input control:
- Name: TextInput1

Formula:
Office365Users.SearchUserV2({ searchTerm: TextInput1.Text, top: 6 }).value


üñºÔ∏è 2) USER PROFILE IMAGE (WITH FALLBACK)
- Add a default image to Media named: user

Image formula:
If(
    !IsBlank(ThisItem.Mail),
    If(
        Office365Users.UserPhotoMetadata(ThisItem.Mail).HasPhoto = true,
        Office365Users.UserPhotoV2(ThisItem.Mail),
        user
    ),
    user
)


‚úÖ 3) SELECT A PERSON
Gallery item OnSelect:
UpdateContext({ varSelectedPerson: ThisItem })


üè∑Ô∏è 4) SHOW SELECTED PERSON IN TEXT INPUT
TextInput1.Default:
varSelectedPerson.DisplayName


‚ôªÔ∏è 5) RESET INPUT + CLEAR SELECTION
Reset button OnSelect:
Reset(TextInput1);
UpdateContext({ varSelectedPerson: Blank() })


‚ÑπÔ∏è NOTE:
This setup can be used to build a reusable Active Directory / People Picker
component that can be placed anywhere in the app.
